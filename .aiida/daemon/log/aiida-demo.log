10/10/2023 03:25:33 PM <1252> aiida.engine.daemon.worker: [ERROR] daemon worker failed to start
Traceback (most recent call last):
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aiormq/connection.py", line 228, in connect
    self.reader, self.writer = await asyncio.open_connection(
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/asyncio/base_events.py", line 1073, in create_connection
    raise exceptions[0]
  File "/opt/conda/envs/aiida/lib/python3.11/asyncio/base_events.py", line 1058, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/asyncio/base_events.py", line 964, in _connect_sock
    await self.sock_connect(sock, address)
  File "/opt/conda/envs/aiida/lib/python3.11/asyncio/selector_events.py", line 633, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/asyncio/selector_events.py", line 668, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 5672)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aiida/engine/daemon/worker.py", line 47, in start_daemon_worker
    runner = manager.create_daemon_runner()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aiida/manage/manager.py", line 434, in create_daemon_runner
    runner = self.create_runner(rmq_submit=True, loop=loop)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aiida/manage/manager.py", line 412, in create_runner
    settings['communicator'] = self.get_communicator()
                               ^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aiida/manage/manager.py", line 283, in get_communicator
    self._communicator = self.create_communicator()
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aiida/manage/manager.py", line 315, in create_communicator
    communicator = kiwipy.rmq.RmqThreadCommunicator.connect(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/kiwipy/rmq/threadcomms.py", line 51, in connect
    comm = cls(
           ^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/kiwipy/rmq/threadcomms.py", line 108, in __init__
    self._communicator: communicator.RmqCommunicator = self._loop_scheduler.await_(
                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/pytray/aiothreads.py", line 164, in await_
    return self.await_submit(awaitable).result(timeout=self.task_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/concurrent/futures/_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/pytray/aiothreads.py", line 178, in coro
    res = await awaitable
          ^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/kiwipy/rmq/communicator.py", line 598, in async_connect
    connection = await connection_factory(**connection_params)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aio_pika/robust_connection.py", line 271, in connect_robust
    return await connect(
           ^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aio_pika/connection.py", line 333, in connect
    await connection.connect(
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aio_pika/robust_connection.py", line 127, in connect
    result = await super().connect(
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aio_pika/connection.py", line 120, in connect
    self.connection = await asyncio.wait_for(
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/asyncio/tasks.py", line 442, in wait_for
    return await fut
           ^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aio_pika/connection.py", line 105, in _make_connection
    connection = await aiormq.connect(self.url, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aiormq/connection.py", line 542, in connect
    await connection.connect(client_properties or {})
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aiormq/base.py", line 168, in wrap
    return await self.create_task(func(self, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aiormq/base.py", line 25, in __inner
    return await self.task
           ^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aiormq/connection.py", line 232, in connect
    raise ConnectionError(*e.args) from e
ConnectionError: [Errno 111] Connect call failed ('127.0.0.1', 5672)
Traceback (most recent call last):
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aiormq/connection.py", line 228, in connect
    self.reader, self.writer = await asyncio.open_connection(
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/asyncio/base_events.py", line 1073, in create_connection
    raise exceptions[0]
  File "/opt/conda/envs/aiida/lib/python3.11/asyncio/base_events.py", line 1058, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/asyncio/base_events.py", line 964, in _connect_sock
    await self.sock_connect(sock, address)
  File "/opt/conda/envs/aiida/lib/python3.11/asyncio/selector_events.py", line 633, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/asyncio/selector_events.py", line 668, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 5672)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/envs/aiida/bin/verdi", line 10, in <module>
    sys.exit(verdi())
             ^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         ^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aiida/cmdline/utils/decorators.py", line 73, in wrapper
    return wrapped(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aiida/cmdline/commands/cmd_daemon.py", line 262, in worker
    start_daemon_worker()
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aiida/engine/daemon/worker.py", line 47, in start_daemon_worker
    runner = manager.create_daemon_runner()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aiida/manage/manager.py", line 434, in create_daemon_runner
    runner = self.create_runner(rmq_submit=True, loop=loop)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aiida/manage/manager.py", line 412, in create_runner
    settings['communicator'] = self.get_communicator()
                               ^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aiida/manage/manager.py", line 283, in get_communicator
    self._communicator = self.create_communicator()
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aiida/manage/manager.py", line 315, in create_communicator
    communicator = kiwipy.rmq.RmqThreadCommunicator.connect(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/kiwipy/rmq/threadcomms.py", line 51, in connect
    comm = cls(
           ^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/kiwipy/rmq/threadcomms.py", line 108, in __init__
    self._communicator: communicator.RmqCommunicator = self._loop_scheduler.await_(
                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/pytray/aiothreads.py", line 164, in await_
    return self.await_submit(awaitable).result(timeout=self.task_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/concurrent/futures/_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/pytray/aiothreads.py", line 178, in coro
    res = await awaitable
          ^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/kiwipy/rmq/communicator.py", line 598, in async_connect
    connection = await connection_factory(**connection_params)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aio_pika/robust_connection.py", line 271, in connect_robust
    return await connect(
           ^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aio_pika/connection.py", line 333, in connect
    await connection.connect(
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aio_pika/robust_connection.py", line 127, in connect
    result = await super().connect(
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aio_pika/connection.py", line 120, in connect
    self.connection = await asyncio.wait_for(
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/asyncio/tasks.py", line 442, in wait_for
    return await fut
           ^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aio_pika/connection.py", line 105, in _make_connection
    connection = await aiormq.connect(self.url, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aiormq/connection.py", line 542, in connect
    await connection.connect(client_properties or {})
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aiormq/base.py", line 168, in wrap
    return await self.create_task(func(self, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aiormq/base.py", line 25, in __inner
    return await self.task
           ^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aiormq/connection.py", line 232, in connect
    raise ConnectionError(*e.args) from e
ConnectionError: [Errno 111] Connect call failed ('127.0.0.1', 5672)
10/10/2023 03:25:33 PM <1253> aiida.engine.daemon.worker: [ERROR] daemon worker failed to start
Traceback (most recent call last):
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aiormq/connection.py", line 228, in connect
    self.reader, self.writer = await asyncio.open_connection(
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/asyncio/base_events.py", line 1073, in create_connection
    raise exceptions[0]
  File "/opt/conda/envs/aiida/lib/python3.11/asyncio/base_events.py", line 1058, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/asyncio/base_events.py", line 964, in _connect_sock
    await self.sock_connect(sock, address)
  File "/opt/conda/envs/aiida/lib/python3.11/asyncio/selector_events.py", line 633, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/asyncio/selector_events.py", line 668, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 5672)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aiida/engine/daemon/worker.py", line 47, in start_daemon_worker
    runner = manager.create_daemon_runner()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aiida/manage/manager.py", line 434, in create_daemon_runner
    runner = self.create_runner(rmq_submit=True, loop=loop)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aiida/manage/manager.py", line 412, in create_runner
    settings['communicator'] = self.get_communicator()
                               ^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aiida/manage/manager.py", line 283, in get_communicator
    self._communicator = self.create_communicator()
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aiida/manage/manager.py", line 315, in create_communicator
    communicator = kiwipy.rmq.RmqThreadCommunicator.connect(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/kiwipy/rmq/threadcomms.py", line 51, in connect
    comm = cls(
           ^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/kiwipy/rmq/threadcomms.py", line 108, in __init__
    self._communicator: communicator.RmqCommunicator = self._loop_scheduler.await_(
                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/pytray/aiothreads.py", line 164, in await_
    return self.await_submit(awaitable).result(timeout=self.task_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/concurrent/futures/_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/pytray/aiothreads.py", line 178, in coro
    res = await awaitable
          ^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/kiwipy/rmq/communicator.py", line 598, in async_connect
    connection = await connection_factory(**connection_params)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aio_pika/robust_connection.py", line 271, in connect_robust
    return await connect(
           ^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aio_pika/connection.py", line 333, in connect
    await connection.connect(
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aio_pika/robust_connection.py", line 127, in connect
    result = await super().connect(
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aio_pika/connection.py", line 120, in connect
    self.connection = await asyncio.wait_for(
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/asyncio/tasks.py", line 442, in wait_for
    return await fut
           ^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aio_pika/connection.py", line 105, in _make_connection
    connection = await aiormq.connect(self.url, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aiormq/connection.py", line 542, in connect
    await connection.connect(client_properties or {})
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aiormq/base.py", line 168, in wrap
    return await self.create_task(func(self, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aiormq/base.py", line 25, in __inner
    return await self.task
           ^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aiormq/connection.py", line 232, in connect
    raise ConnectionError(*e.args) from e
ConnectionError: [Errno 111] Connect call failed ('127.0.0.1', 5672)
Traceback (most recent call last):
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aiormq/connection.py", line 228, in connect
    self.reader, self.writer = await asyncio.open_connection(
                               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/asyncio/streams.py", line 48, in open_connection
    transport, _ = await loop.create_connection(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/asyncio/base_events.py", line 1073, in create_connection
    raise exceptions[0]
  File "/opt/conda/envs/aiida/lib/python3.11/asyncio/base_events.py", line 1058, in create_connection
    sock = await self._connect_sock(
           ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/asyncio/base_events.py", line 964, in _connect_sock
    await self.sock_connect(sock, address)
  File "/opt/conda/envs/aiida/lib/python3.11/asyncio/selector_events.py", line 633, in sock_connect
    return await fut
           ^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/asyncio/selector_events.py", line 668, in _sock_connect_cb
    raise OSError(err, f'Connect call failed {address}')
ConnectionRefusedError: [Errno 111] Connect call failed ('127.0.0.1', 5672)

The above exception was the direct cause of the following exception:

Traceback (most recent call last):
  File "/opt/conda/envs/aiida/bin/verdi", line 10, in <module>
    sys.exit(verdi())
             ^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/click/core.py", line 1157, in __call__
    return self.main(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/click/core.py", line 1078, in main
    rv = self.invoke(ctx)
         ^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/click/core.py", line 1688, in invoke
    return _process_result(sub_ctx.command.invoke(sub_ctx))
                           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/click/core.py", line 1434, in invoke
    return ctx.invoke(self.callback, **ctx.params)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/click/core.py", line 783, in invoke
    return __callback(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aiida/cmdline/utils/decorators.py", line 73, in wrapper
    return wrapped(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aiida/cmdline/commands/cmd_daemon.py", line 262, in worker
    start_daemon_worker()
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aiida/engine/daemon/worker.py", line 47, in start_daemon_worker
    runner = manager.create_daemon_runner()
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aiida/manage/manager.py", line 434, in create_daemon_runner
    runner = self.create_runner(rmq_submit=True, loop=loop)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aiida/manage/manager.py", line 412, in create_runner
    settings['communicator'] = self.get_communicator()
                               ^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aiida/manage/manager.py", line 283, in get_communicator
    self._communicator = self.create_communicator()
                         ^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aiida/manage/manager.py", line 315, in create_communicator
    communicator = kiwipy.rmq.RmqThreadCommunicator.connect(
                   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/kiwipy/rmq/threadcomms.py", line 51, in connect
    comm = cls(
           ^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/kiwipy/rmq/threadcomms.py", line 108, in __init__
    self._communicator: communicator.RmqCommunicator = self._loop_scheduler.await_(
                                                       ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/pytray/aiothreads.py", line 164, in await_
    return self.await_submit(awaitable).result(timeout=self.task_timeout)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/concurrent/futures/_base.py", line 456, in result
    return self.__get_result()
           ^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/concurrent/futures/_base.py", line 401, in __get_result
    raise self._exception
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/pytray/aiothreads.py", line 178, in coro
    res = await awaitable
          ^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/kiwipy/rmq/communicator.py", line 598, in async_connect
    connection = await connection_factory(**connection_params)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aio_pika/robust_connection.py", line 271, in connect_robust
    return await connect(
           ^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aio_pika/connection.py", line 333, in connect
    await connection.connect(
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aio_pika/robust_connection.py", line 127, in connect
    result = await super().connect(
             ^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aio_pika/connection.py", line 120, in connect
    self.connection = await asyncio.wait_for(
                      ^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/asyncio/tasks.py", line 442, in wait_for
    return await fut
           ^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aio_pika/connection.py", line 105, in _make_connection
    connection = await aiormq.connect(self.url, **kwargs)
                 ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aiormq/connection.py", line 542, in connect
    await connection.connect(client_properties or {})
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aiormq/base.py", line 168, in wrap
    return await self.create_task(func(self, *args, **kwargs))
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aiormq/base.py", line 25, in __inner
    return await self.task
           ^^^^^^^^^^^^^^^
  File "/opt/conda/envs/aiida/lib/python3.11/site-packages/aiormq/connection.py", line 232, in connect
    raise ConnectionError(*e.args) from e
ConnectionError: [Errno 111] Connect call failed ('127.0.0.1', 5672)
